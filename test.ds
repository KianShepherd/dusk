struct Foo {
    a: int,

    fn Foo(self: Foo) -> Foo {
        println("Init Foo: rc = %d", self._rc);
        return self;
    }

    fn __del__(self: Foo) {
        println("Del Foo");
    }

    fn __INCREF__(self: Foo) {
        println("__INCREF__ Foo: %d", self._rc);
        self._rc = self._rc + 1;
        println("__INCREF__ Foo: %d", self._rc);
    }

    fn __DECREF__(self: Foo) {
        println("__DECREF__ Foo: %d", self._rc);
        self._rc = self._rc - 1;
        println("__DECREF__ Foo: %d", self._rc);
        if self._rc == 0 {
            println("DELETING");
            self.__del__();
            println("DELETED");
        }
    }
}


fn main(argc: int, argv: string*) -> int {
    let mut a: Foo = Foo();
    a.__INCREF__();
    a.__DECREF__();
    a.__DECREF__();
    println("done");
    return 0;
}
